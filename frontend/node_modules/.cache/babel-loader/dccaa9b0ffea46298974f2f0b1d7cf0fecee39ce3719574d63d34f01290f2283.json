{"ast":null,"code":"import { takeLatest, call, put } from 'redux-saga/effects';\nimport { authAPI } from '../../services/api';\nimport { LOGIN_REQUEST, REGISTER_REQUEST, LOGOUT_REQUEST, GET_PROFILE_REQUEST, UPDATE_PROFILE_REQUEST } from '../actions';\nimport { loginStart, loginSuccess, loginFailure, registerStart, registerSuccess, registerFailure, logout, updateProfile } from '../reducers/authSlice';\n\n// Login saga\nfunction* loginSaga(action) {\n  try {\n    console.log('Login saga started with payload:', action.payload);\n    yield put(loginStart());\n    console.log('Making API call to login endpoint...');\n    const response = yield call(authAPI.login, action.payload);\n    console.log('Login API response:', response.data);\n    yield put(loginSuccess(response.data));\n    console.log('Login success action dispatched');\n  } catch (error) {\n    var _error$response, _error$response2, _error$response3;\n    console.error('Login saga error:', error);\n    console.error('Error details:', {\n      status: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status,\n      data: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data,\n      message: error.message\n    });\n\n    // Don't let 401 errors trigger the interceptor redirect during login\n    if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 401) {\n      var _error$response4, _error$response4$data;\n      const errorMessage = ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.error) || 'Invalid email or password';\n      yield put(loginFailure(errorMessage));\n    } else {\n      var _error$response5, _error$response5$data;\n      const errorMessage = ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.error) || 'Login failed. Please try again.';\n      yield put(loginFailure(errorMessage));\n    }\n  }\n}\n\n// Register saga\nfunction* registerSaga(action) {\n  try {\n    yield put(registerStart());\n    const response = yield call(authAPI.register, action.payload);\n    yield put(registerSuccess(response.data));\n  } catch (error) {\n    var _error$response6, _error$response6$data;\n    const errorMessage = ((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.error) || 'Registration failed';\n    yield put(registerFailure(errorMessage));\n  }\n}\n\n// Logout saga\nfunction* logoutSaga() {\n  try {\n    yield put(logout());\n  } catch (error) {\n    console.error('Logout error:', error);\n  }\n}\n\n// Get profile saga\nfunction* getProfileSaga() {\n  try {\n    const response = yield call(authAPI.getProfile);\n    yield put(loginSuccess({\n      user: response.data.user,\n      token: localStorage.getItem('token')\n    }));\n  } catch (error) {\n    var _error$response7;\n    console.error('Get profile error:', error);\n    // If token is invalid, logout\n    if (((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : _error$response7.status) === 401) {\n      yield put(logout());\n    }\n  }\n}\n\n// Update profile saga\nfunction* updateProfileSaga(action) {\n  try {\n    const response = yield call(authAPI.updateProfile, action.payload);\n    yield put(updateProfile(response.data.user));\n  } catch (error) {\n    var _error$response8, _error$response8$data;\n    const errorMessage = ((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : (_error$response8$data = _error$response8.data) === null || _error$response8$data === void 0 ? void 0 : _error$response8$data.error) || 'Profile update failed';\n    console.error('Update profile error:', errorMessage);\n  }\n}\n\n// Auth saga watcher\nexport default function* authSaga() {\n  yield takeLatest(LOGIN_REQUEST, loginSaga);\n  yield takeLatest(REGISTER_REQUEST, registerSaga);\n  yield takeLatest(LOGOUT_REQUEST, logoutSaga);\n  yield takeLatest(GET_PROFILE_REQUEST, getProfileSaga);\n  yield takeLatest(UPDATE_PROFILE_REQUEST, updateProfileSaga);\n}","map":{"version":3,"names":["takeLatest","call","put","authAPI","LOGIN_REQUEST","REGISTER_REQUEST","LOGOUT_REQUEST","GET_PROFILE_REQUEST","UPDATE_PROFILE_REQUEST","loginStart","loginSuccess","loginFailure","registerStart","registerSuccess","registerFailure","logout","updateProfile","loginSaga","action","console","log","payload","response","login","data","error","_error$response","_error$response2","_error$response3","status","message","_error$response4","_error$response4$data","errorMessage","_error$response5","_error$response5$data","registerSaga","register","_error$response6","_error$response6$data","logoutSaga","getProfileSaga","getProfile","user","token","localStorage","getItem","_error$response7","updateProfileSaga","_error$response8","_error$response8$data","authSaga"],"sources":["/Users/rigobert/Documents/ISCO/frontend/src/store/sagas/authSaga.js"],"sourcesContent":["import { takeLatest, call, put } from 'redux-saga/effects';\nimport { authAPI } from '../../services/api';\nimport {\n  LOGIN_REQUEST,\n  REGISTER_REQUEST,\n  LOGOUT_REQUEST,\n  GET_PROFILE_REQUEST,\n  UPDATE_PROFILE_REQUEST,\n} from '../actions';\nimport {\n  loginStart,\n  loginSuccess,\n  loginFailure,\n  registerStart,\n  registerSuccess,\n  registerFailure,\n  logout,\n  updateProfile,\n} from '../reducers/authSlice';\n\n// Login saga\nfunction* loginSaga(action) {\n  try {\n    console.log('Login saga started with payload:', action.payload);\n    yield put(loginStart());\n    \n    console.log('Making API call to login endpoint...');\n    const response = yield call(authAPI.login, action.payload);\n    console.log('Login API response:', response.data);\n    \n    yield put(loginSuccess(response.data));\n    console.log('Login success action dispatched');\n  } catch (error) {\n    console.error('Login saga error:', error);\n    console.error('Error details:', {\n      status: error.response?.status,\n      data: error.response?.data,\n      message: error.message\n    });\n    \n    // Don't let 401 errors trigger the interceptor redirect during login\n    if (error.response?.status === 401) {\n      const errorMessage = error.response?.data?.error || 'Invalid email or password';\n      yield put(loginFailure(errorMessage));\n    } else {\n      const errorMessage = error.response?.data?.error || 'Login failed. Please try again.';\n      yield put(loginFailure(errorMessage));\n    }\n  }\n}\n\n// Register saga\nfunction* registerSaga(action) {\n  try {\n    yield put(registerStart());\n    const response = yield call(authAPI.register, action.payload);\n    yield put(registerSuccess(response.data));\n  } catch (error) {\n    const errorMessage = error.response?.data?.error || 'Registration failed';\n    yield put(registerFailure(errorMessage));\n  }\n}\n\n// Logout saga\nfunction* logoutSaga() {\n  try {\n    yield put(logout());\n  } catch (error) {\n    console.error('Logout error:', error);\n  }\n}\n\n// Get profile saga\nfunction* getProfileSaga() {\n  try {\n    const response = yield call(authAPI.getProfile);\n    yield put(loginSuccess({ user: response.data.user, token: localStorage.getItem('token') }));\n  } catch (error) {\n    console.error('Get profile error:', error);\n    // If token is invalid, logout\n    if (error.response?.status === 401) {\n      yield put(logout());\n    }\n  }\n}\n\n// Update profile saga\nfunction* updateProfileSaga(action) {\n  try {\n    const response = yield call(authAPI.updateProfile, action.payload);\n    yield put(updateProfile(response.data.user));\n  } catch (error) {\n    const errorMessage = error.response?.data?.error || 'Profile update failed';\n    console.error('Update profile error:', errorMessage);\n  }\n}\n\n// Auth saga watcher\nexport default function* authSaga() {\n  yield takeLatest(LOGIN_REQUEST, loginSaga);\n  yield takeLatest(REGISTER_REQUEST, registerSaga);\n  yield takeLatest(LOGOUT_REQUEST, logoutSaga);\n  yield takeLatest(GET_PROFILE_REQUEST, getProfileSaga);\n  yield takeLatest(UPDATE_PROFILE_REQUEST, updateProfileSaga);\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}